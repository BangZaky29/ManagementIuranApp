[
    {
        "schemaname": "public",
        "tablename": "fees",
        "policyname": "Public can view fees",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "SELECT",
        "using_expression": "(is_active = true)",
        "check_expression": null
    },
    {
        "schemaname": "public",
        "tablename": "fees",
        "policyname": "Admins can manage fees",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "ALL",
        "using_expression": "is_admin()",
        "check_expression": null
    },
    {
        "schemaname": "public",
        "tablename": "housing_complexes",
        "policyname": "Enable insert for admins safe",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "INSERT",
        "using_expression": null,
        "check_expression": "is_admin()"
    },
    {
        "schemaname": "public",
        "tablename": "housing_complexes",
        "policyname": "Enable read access for authenticated users",
        "permissive": "PERMISSIVE",
        "roles": "{authenticated}",
        "operation": "SELECT",
        "using_expression": "true",
        "check_expression": null
    },
    {
        "schemaname": "public",
        "tablename": "news",
        "policyname": "Enable read access for all users",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "SELECT",
        "using_expression": "true",
        "check_expression": null
    },
    {
        "schemaname": "public",
        "tablename": "news",
        "policyname": "Enable update for authenticated users only",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "UPDATE",
        "using_expression": "(auth.role() = 'authenticated'::text)",
        "check_expression": null
    },
    {
        "schemaname": "public",
        "tablename": "news",
        "policyname": "Enable insert for authenticated users only",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "INSERT",
        "using_expression": null,
        "check_expression": "(auth.role() = 'authenticated'::text)"
    },
    {
        "schemaname": "public",
        "tablename": "news",
        "policyname": "Enable delete for authenticated users only",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "DELETE",
        "using_expression": "(auth.role() = 'authenticated'::text)",
        "check_expression": null
    },
    {
        "schemaname": "public",
        "tablename": "panic_logs",
        "policyname": "Users can trigger panic",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "INSERT",
        "using_expression": null,
        "check_expression": "(auth.uid() = user_id)"
    },
    {
        "schemaname": "public",
        "tablename": "panic_logs",
        "policyname": "Staff can manage panic logs",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "ALL",
        "using_expression": "(is_admin() OR is_security())",
        "check_expression": null
    },
    {
        "schemaname": "public",
        "tablename": "payments",
        "policyname": "Payment Isolation",
        "permissive": "PERMISSIVE",
        "roles": "{authenticated}",
        "operation": "SELECT",
        "using_expression": "((user_id = auth.uid()) OR ((( SELECT profiles.role\n   FROM profiles\n  WHERE (profiles.id = auth.uid())) = 'admin'::user_role) AND (( SELECT profiles.housing_complex_id\n   FROM profiles\n  WHERE (profiles.id = payments.user_id)) = ( SELECT profiles.housing_complex_id\n   FROM profiles\n  WHERE (profiles.id = auth.uid())))))",
        "check_expression": null
    },
    {
        "schemaname": "public",
        "tablename": "payments",
        "policyname": "Users can view own payments",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "SELECT",
        "using_expression": "(auth.uid() = user_id)",
        "check_expression": null
    },
    {
        "schemaname": "public",
        "tablename": "payments",
        "policyname": "Users can create payments",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "INSERT",
        "using_expression": null,
        "check_expression": "(auth.uid() = user_id)"
    },
    {
        "schemaname": "public",
        "tablename": "payments",
        "policyname": "Admins can manage payments",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "ALL",
        "using_expression": "is_admin()",
        "check_expression": null
    },
    {
        "schemaname": "public",
        "tablename": "profiles",
        "policyname": "Users can insert own profile",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "INSERT",
        "using_expression": null,
        "check_expression": "(auth.uid() = id)"
    },
    {
        "schemaname": "public",
        "tablename": "profiles",
        "policyname": "Profiles are viewable by everyone",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "SELECT",
        "using_expression": "true",
        "check_expression": null
    },
    {
        "schemaname": "public",
        "tablename": "profiles",
        "policyname": "View Profiles",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "SELECT",
        "using_expression": "((auth.uid() = id) OR is_admin())",
        "check_expression": null
    },
    {
        "schemaname": "public",
        "tablename": "profiles",
        "policyname": "Update Profiles",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "UPDATE",
        "using_expression": "((auth.uid() = id) OR is_admin())",
        "check_expression": null
    },
    {
        "schemaname": "public",
        "tablename": "profiles",
        "policyname": "Insert Profiles",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "INSERT",
        "using_expression": null,
        "check_expression": "(auth.uid() = id)"
    },
    {
        "schemaname": "public",
        "tablename": "profiles",
        "policyname": "Users can update own profile",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "UPDATE",
        "using_expression": "(auth.uid() = id)",
        "check_expression": null
    },
    {
        "schemaname": "public",
        "tablename": "reports",
        "policyname": "Users can view own reports",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "SELECT",
        "using_expression": "(auth.uid() = user_id)",
        "check_expression": null
    },
    {
        "schemaname": "public",
        "tablename": "reports",
        "policyname": "Users can delete own reports",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "DELETE",
        "using_expression": "(auth.uid() = user_id)",
        "check_expression": null
    },
    {
        "schemaname": "public",
        "tablename": "reports",
        "policyname": "Staff can manage reports",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "ALL",
        "using_expression": "(is_admin() OR is_security())",
        "check_expression": null
    },
    {
        "schemaname": "public",
        "tablename": "reports",
        "policyname": "Users can insert own reports",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "INSERT",
        "using_expression": null,
        "check_expression": "(auth.uid() = user_id)"
    },
    {
        "schemaname": "public",
        "tablename": "reports",
        "policyname": "Public read access",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "SELECT",
        "using_expression": "true",
        "check_expression": null
    },
    {
        "schemaname": "public",
        "tablename": "reports",
        "policyname": "Users can update own reports",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "UPDATE",
        "using_expression": "(auth.uid() = user_id)",
        "check_expression": null
    },
    {
        "schemaname": "public",
        "tablename": "reports",
        "policyname": "Users can create reports",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "INSERT",
        "using_expression": null,
        "check_expression": "(auth.uid() = user_id)"
    },
    {
        "schemaname": "public",
        "tablename": "reports",
        "policyname": "Report Isolation",
        "permissive": "PERMISSIVE",
        "roles": "{authenticated}",
        "operation": "ALL",
        "using_expression": "((user_id = auth.uid()) OR ((( SELECT profiles.role\n   FROM profiles\n  WHERE (profiles.id = auth.uid())) = 'admin'::user_role) AND (( SELECT profiles.housing_complex_id\n   FROM profiles\n  WHERE (profiles.id = reports.user_id)) = ( SELECT profiles.housing_complex_id\n   FROM profiles\n  WHERE (profiles.id = auth.uid())))))",
        "check_expression": null
    },
    {
        "schemaname": "public",
        "tablename": "verified_residents",
        "policyname": "Admins can manage verified_residents_safe",
        "permissive": "PERMISSIVE",
        "roles": "{public}",
        "operation": "ALL",
        "using_expression": "is_admin()",
        "check_expression": null
    }
]